<@pageContainer>
    <@pageColumn>
        <@pageHeader title='#i18n{portal.users.modify_attribute.pageTitleAttributeComboBox}' />
		<@breadcrumbs class='mb-2'>
			<@breadcrumbItem><@link href='jsp/admin/AdminTechnicalMenu.jsp' label='#i18n{portal.admindashboard.view_dashboards.title}' /></@breadcrumbItem>
			<@breadcrumbItem><@link href='jsp/admin/AdminTechnicalMenu.jsp#attributes_management' label='#i18n{portal.users.manage_attributes.pageTitle}' /></@breadcrumbItem>
			<@breadcrumbItem>#i18n{portal.users.create_attribute.pageTitleAttributeComboBox}</@breadcrumbItem>
		</@breadcrumbs>
		<@row>
			<@columns md=4>
				<@tform action='jsp/admin/user/attribute/DoModifyAttribute.jsp' method='post' boxed=true>
					<@input type='hidden' name='token' value='${token}' />
					<@formGroup labelKey='#i18n{portal.users.modify_attribute.labelTitle}' labelFor='attr_title' helpKey='#i18n{portal.users.modify_attribute.labelTitleComment}' mandatory=true>
						<@input type='text' name='title' id='attr_title' value='${attribute.title?html}' maxlength=255 inputSize=80 />
					</@formGroup>
					<@formGroup labelKey='#i18n{portal.users.modify_attribute.labelHelpMessage}' labelFor='help_message' helpKey='#i18n{portal.users.modify_attribute.labelHelpMessageComment}'>
						<@input type='textarea' name='help_message' id='help_message' cols=80 rows=5>${attribute.helpMessage?html}</@input>
					</@formGroup>
					<@formGroup>
						<@checkBox orientation='switch' name='is_shown_in_search' id='is_shown_in_search' value='1' checked=attribute.shownInSearch labelKey='#i18n{portal.users.modify_attribute.labelIsShownInSearch}' />
					</@formGroup>
					<@formGroup>
						<@checkBox orientation='switch' name='is_shown_in_result_list' id='is_shown_in_result_list' value='1' checked=attribute.shownInResultList labelKey='#i18n{portal.users.modify_attribute.labelIsShownInResultList}' />
					</@formGroup>
					<@formGroup>
						<@checkBox orientation='switch' name='mandatory' id='mandatory' value='1' checked=attribute.mandatory labelKey='#i18n{portal.users.modify_attribute.labelMandatory}' />
					</@formGroup>
					<@formGroup helpKey='#i18n{portal.users.create_attribute.labelMultipleComment}'>
						<#list attribute_fields_list as attribute_field>
							<#if attribute_field.multiple = false>
								<#assign checked = false>
							<#else>
								<#assign checked = true>
							</#if>
							<@checkBox orientation='switch' name='multiple' id='multiple' labelKey='#i18n{portal.users.create_attribute.labelMultiple}' value='1' checked=checked />
							<#break>
						</#list>
					</@formGroup>
					<@formGroup>
						<@input type='hidden' name='id_attribute' value='${attribute.idAttribute}' />
						<@button type='submit' name='validate' value='validate' buttonIcon='check' title='#i18n{portal.users.create_attribute.buttonValidate}' color='primary' hideTitle=['xs'] />
						<@button type='submit' name='apply' value='apply' buttonIcon='check-circle' title='#i18n{portal.users.create_attribute.buttonApply}' color='primary' hideTitle=['xs'] />
						<@button type='submit' name='cancel' value='cancel' buttonIcon='times' title='#i18n{portal.admin.message.buttonCancel}' cancel=true color='secondary'  hideTitle=['xs'] />
					</@formGroup>
				</@tform>
  			</@columns>
			<@columns md=8>
				<#assign anchor><@link name='list' /></#assign>
				<@box>
					<@boxHeader title='${anchor} #i18n{portal.users.modify_attribute.listAssociatedFields}' boxTools=true>
						<@offcanvas targetUrl="jsp/admin/user/attribute/CreateAttributeField.jsp?id_attribute=${attribute.idAttribute}&create=" targetElement="#create-attr-field" redirectForm=false id="style-create" title="#i18n{portal.users.modify_attribute.buttonCreateField}" btnTitle="#i18n{portal.users.modify_attribute.buttonCreateField}" btnIcon="plus" position="end" hideTitle=['xs'] />
					</@boxHeader>
					<@boxBody>
						<@manageFeature id='list'>
						<#assign cpt = 0>
						<#list attribute_fields_list as attribute_field>
							<#if attribute_field.title?exists>
								<#assign cpt = cpt + 1>
								<@manageFeatureItem>
									<@manageFeatureItemColumn>
										${attribute_field.title} - ${attribute_field.value}
									</@manageFeatureItemColumn>
									<@manageFeatureItemColumn align='end'>
										<#if attribute_field.defaultValue><@tag color='success'>#i18n{portal.users.modify_attribute.defaultValue}</@tag></#if>
									</@manageFeatureItemColumn>
									<@manageFeatureItemColumn align='end'>
										<@offcanvas targetUrl="jsp/admin/user/attribute/ModifyAttributeField.jsp?id_attribute=${attribute.idAttribute}&amp;id_field=${attribute_field.idField}" targetElement="#modify-attr-field" redirectForm=false id="modify-attr-${attribute_field.idField}" title="#i18n{portal.users.modify_attribute.buttonLabelModify}" btnTitle="#i18n{portal.users.modify_attribute.buttonLabelModify}" btnIcon="edit" position="end" hideTitle=['xs'] />
										<#if cpt != 1>
											<@tform method='post' action='jsp/admin/user/attribute/DoMoveUpAttributeField.jsp#list'>
												<@input type='hidden' name='id_attribute' value='${attribute.idAttribute?html}' />
												<@input type='hidden' name='id_field' value='${attribute_field.idField?html}' />
												<@input type='hidden' name='token' value='${token}' />
												<@button type='submit' title='#i18n{portal.users.modify_attribute.buttonLabelMoveUp}' buttonIcon='chevron-up' />
											</@tform>
										</#if>
										<#if attribute_field_has_next>
											<@tform method='post' action='jsp/admin/user/attribute/DoMoveDownAttributeField.jsp#list'>
												<@input type='hidden' name='id_attribute' value='${attribute.idAttribute?html}' />
												<@input type='hidden' name='id_field' value='${attribute_field.idField?html}' />
												<@input type='hidden' name='token' value='${token}' />
												<@button type='submit' title='#i18n{portal.users.modify_attribute.buttonLabelMoveDown}' buttonIcon='chevron-down' />
											</@tform>
										</#if>
										<@aButton href='jsp/admin/user/attribute/RemoveAttributeField.jsp?id_attribute=${attribute.idAttribute}&amp;id_field=${attribute_field.idField}' buttonIcon='trash' title='#i18n{portal.users.modify_attribute.buttonLabelDelete}' color='danger' />
									</@manageFeatureItemColumn>
								</@manageFeatureItem>
							</#if>
						</#list>
						</@manageFeature>
					</@boxBody>
				</@box>
			</@columns>
		</@row>
	</@pageColumn>
</@pageContainer>