<@pageContainer>
<@pageColumn>
	<@pageHeader title='#i18n{portal.system.manage_caches.titleCacheList}'>
		<@tform method='post' action='jsp/admin/system/DoReloadProperties.jsp' type='inline'>
			<@input type='hidden' name='token' value='${token}' />
			<@button type='submit' buttonIcon='sync' title='#i18n{portal.system.manage_caches.titleReloadProperties}' hideTitle=['xs','sm'] />
		</@tform>
		<@tform method='post' action='jsp/admin/system/DoResetCaches.jsp' type='inline'>
			<@input type='hidden' name='token' value='${token}' />
			<@button type='submit' buttonIcon='trash' title='#i18n{portal.system.manage_caches.buttonFlush}' color='danger'	hideTitle=['xs','sm'] />
		</@tform>
	</@pageHeader>
	<@div class='mt-3'>
		<@alert class='alert-minor' title='#i18n{portal.system.manage_caches.featureDescription}' iconTitle='info-circle'/>
		<@alert class='alert-warning alert-important' color='danger' title='#i18n{portal.system.manage_caches.cautionTitle}' iconTitle='exclamation-circle'>#i18n{portal.system.manage_caches.cautionMessage}</@alert>
	</@div>
	<@manageFeature>
	<#assign id=0>
		<#list services_list as service>
		<@manageFeatureItem>
			<@manageFeatureItemColumn auto=true>
			<#if service.cacheEnable>
				<@tag color='success' title='#i18n{portal.system.manage_caches.imgAltEnable}'><@icon style='check' /></@tag>
			<#else>
				<@tag color='danger' title='#i18n{portal.system.manage_caches.imgAltDisable}'><@icon style='times' /></@tag>
			</#if>
			</@manageFeatureItemColumn>
			<@manageFeatureItemColumn cols='12 col-md-3'>
				<strong>${service.name}</strong>
				<br>
				<small>
				#i18n{portal.system.manage_caches.columnTitleMaxElements}: ${service.maxElements!"-"} 
				<br>
				#i18n{portal.system.manage_caches.columnTitleTimeToLive} : ${service.timeToLive} -> ${ time2string( service.timeToLive )}
				</small>
			</@manageFeatureItemColumn>
			<@manageFeatureItemColumn cols='12 col-md-3'>
				<p>#i18n{portal.system.manage_caches.columnTitleCacheSize} : ${service.cacheSize}</p>
				<p>#i18n{portal.system.manage_caches.columnTitleMemorySize} : ${service.memorySize}</p>
			</@manageFeatureItemColumn>
			<@manageFeatureItemColumn cols='12 col-md-5' class='ms-auto' >
				<@offcanvas targetUrl="jsp/admin/system/CacheInfos.jsp?id_cache=${id}" targetElement="#cache-infos" id="cache-${id}" title="${service.name}" btnIcon="eye me-2" btnTitle="#i18n{portal.util.labelMore}" btnTitleShow=false  btnColor="outline-secondary w-50" position="end" />
				<@tform method='post' type='inline' align="middle"
					action='jsp/admin/system/ConfirmToggleCache.jsp'>
					<@input type='hidden' name='id_cache' value='${id}' />
					<@input type='hidden' name='token' value='${token}' />
					<#if service.cacheEnable>
						<@button type='submit' buttonIcon='stop' title='#i18n{portal.system.manage_caches.actionDisable}' color='danger' />
					<#else>
						<@button type='submit' buttonIcon='play' title='#i18n{portal.system.manage_caches.actionEnable}' color='success' />
					</#if>
				</@tform>
				<@tform method='post' type='inline' align="middle" action='jsp/admin/system/DoResetCaches.jsp'>
					<@input type='hidden' name='id_cache' value='${id}' />
					<@input type='hidden' name='token' value='${token}' />
					<@button type='submit' buttonIcon='trash' title='#i18n{portal.system.manage_caches.actionClear}' color='danger' />
				</@tform>
				
			</@manageFeatureItemColumn>
		</@manageFeatureItem>
		<#assign id=id + 1>
	</#list>
	</@manageFeature>
</@pageColumn>
</@pageContainer>
<#function time2string time>
<#assign hour=( time / 3600 )?floor>
<#assign mn=((time - (hour * 3600)) / 60)?floor>
<#if hour !=0>
	<#assign result='' + hour + 'h'>
	<#if mn !=0>
		<#assign result=result + ' ' + mn + 'mn'>
	</#if>
<#else>
	<#assign result='' + mn + 'mn'>
</#if>
<#return result>
</#function>
